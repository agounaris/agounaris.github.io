<!doctype html><html lang=en-us><head><title>PHP Auto correction/spell check, speed testing &#183; Argys Corner</title><meta name=generator content="Hugo 0.82.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=author content="Argyrios Gounaris"><meta name=description content><link rel=canonical href=https://agounaris.github.io/2014/02/12/php-auto-correction/spell-check-speed-testing/><link rel=icon href=https://agounaris.github.io/favicon.ico><link rel=apple-touch-icon href=https://agounaris.github.io/apple-touch-icon.png><link rel=stylesheet href=https://agounaris.github.io/css/style.css><link rel=stylesheet href=https://agounaris.github.io/css/font-awesome.min.css><link rel=stylesheet href=https://agounaris.github.io/css/monokai.css><link rel=stylesheet href=https://agounaris.github.io/fancybox/jquery.fancybox.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600" rel=stylesheet type=text/css><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel=stylesheet type=text/css><meta property="og:title" content="PHP Auto correction/spell check, speed testing"><meta property="og:description" content="Auto-correction/spell checking is probably one of the most used functionalities over the web.
Has anyone thought how it is working?? How blogs, websites, that run clearly over the web, are able to serve the list nearly instantly??
I was really curious the other day and I wanted to spend some minutes crafting a small algori	thm to study the functionality.
I&rsquo;ve googled a bit arround for dictionaries and I&rsquo;ve found (this one)."><meta property="og:type" content="article"><meta property="og:url" content="https://agounaris.github.io/2014/02/12/php-auto-correction/spell-check-speed-testing/"><meta property="article:section" content="post"><meta property="article:published_time" content="2014-02-12T02:13:50+00:00"><meta property="article:modified_time" content="2014-02-12T02:13:50+00:00"><meta itemprop=name content="PHP Auto correction/spell check, speed testing"><meta itemprop=description content="Auto-correction/spell checking is probably one of the most used functionalities over the web.
Has anyone thought how it is working?? How blogs, websites, that run clearly over the web, are able to serve the list nearly instantly??
I was really curious the other day and I wanted to spend some minutes crafting a small algori	thm to study the functionality.
I&rsquo;ve googled a bit arround for dictionaries and I&rsquo;ve found (this one)."><meta itemprop=datePublished content="2014-02-12T02:13:50+00:00"><meta itemprop=dateModified content="2014-02-12T02:13:50+00:00"><meta itemprop=wordCount content="617"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="PHP Auto correction/spell check, speed testing"><meta name=twitter:description content="Auto-correction/spell checking is probably one of the most used functionalities over the web.
Has anyone thought how it is working?? How blogs, websites, that run clearly over the web, are able to serve the list nearly instantly??
I was really curious the other day and I wanted to spend some minutes crafting a small algori	thm to study the functionality.
I&rsquo;ve googled a bit arround for dictionaries and I&rsquo;ve found (this one)."><meta name=twitter:site content="@gohugoio"><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js></script></head><body><div class=container><div id=container><header id=header><div id=header-main class=header-inner><div class=outer><a href=https://agounaris.github.io/ id=logo><i class=logo style=background-image:url(https://agounaris.github.io/css/images/logo.png)></i>
<span class=site-title>Argys Corner</span></a><nav id=main-nav><a class=main-nav-link href=https://agounaris.github.io/>Home</a>
<a class=main-nav-link href=https://agounaris.github.io/tags/>Tags</a>
<a class=main-nav-link href=https://agounaris.github.io/categories/>Categories</a></nav><nav id=sub-nav><div class=profile id=profile-nav><a id=profile-anchor href=javascript:;><img class=avatar src=https://agounaris.github.io/css/images/avatar.png><i class="fa fa-caret-down"></i></a></div></nav><div id=search-form-wrap><form action=//google.com/search method=get accept-charset=utf-8 class=search-form><input type=search name=q class=search-form-input placeholder>
<button type=submit class=search-form-submit></button>
<input type=hidden name=sitesearch value=https://agounaris.github.io/></form></div></div></div><div id=main-nav-mobile class="header-sub header-inner"><table class="menu outer"><tbody><tr><td><a class=main-nav-link href=https://agounaris.github.io/>Home</a></td><td><a class=main-nav-link href=https://agounaris.github.io/tags/>Tags</a></td><td><a class=main-nav-link href=https://agounaris.github.io/categories/>Categories</a></td><td><form action=//google.com/search method=get accept-charset=utf-8 class=search-form><input type=search name=q class=search-form-input placeholder=Search>
<input type=hidden name=sitesearch value=https://agounaris.github.io/></form></td></tr></tbody></table></div></header><div class=outer><aside id=profile><div class="inner profile-inner"><div class="base-info profile-block"><img id=avatar src="https://www.gravatar.com/avatar/4fca794da0cf08804f99048d3c8b39c1?s=100&d=identicon"><h2 id=name>Argyrios Gounaris</h2><h3 id=title>Blogger - Programmer - Gopher</h3><span id=location><i class="fa fa-map-marker"></i>Earth</span>
<a id=follow href=https://github.com/gohugoio></a></div><div class="article-info profile-block"><div class=article-info-block>18
<span></span></div><div class=article-info-block>3
<span></span></div></div><div class="profile-block social-links"><table><tr><td><a href=//github.com/gohugoio target=_blank title=GitHub><i class="fa fa-github"></i></a></td><td><a href=//twitter.com/gohugoio target=_blank title=Twitter><i class="fa fa-twitter"></i></a></td><td><a href=https://agounaris.github.io/index.xml target=_blank title=RSS><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id=main><article id=page-undefined class="article article-type-page" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><a href=https://agounaris.github.io/2014/02/12/php-auto-correction/spell-check-speed-testing/><h1 class=article-title itemprop=name>PHP Auto correction/spell check, speed testing</h1></a><div class=article-meta><div class=article-date><i class="fa fa-calendar"></i>
<time datetime="2014-02-12 02:13:50 +0000 UTC" itemprop=datePublished>2014-02-12</time>
&#183;
617
&#183;
3</div></div></header><div class=article-entry itemprop=articleBody><p>Auto-correction/spell checking is probably one of the most used functionalities over the web.</p><p>Has anyone thought how it is working?? How blogs, websites, that run clearly over the web, are
able to serve the list nearly instantly??</p><p>I was really curious the other day and I wanted to spend some minutes crafting a small algori thm
to study the functionality.</p><p>I&rsquo;ve googled a bit arround for dictionaries and I&rsquo;ve found (<a href=https://github.com/agounaris/php_playground/blob/master/CmdSpellCorrection/dictionary.txt>this one</a>). It&rsquo;s not perfect but enough to
get me started.</p><p>Let start&mldr;my plan is to load all the words of the file to an array. Slice the array based on the
first letter of the word and match somes letter based on their index.</p><p>{% highlight php %}</p><p>{% endhighlight %}</p><p>I prefer fopen because its quite faster that file_get_contents for example.</p><p>I will get the words from the command line&mldr;</p><p>{% highlight php %}</p><p>{% endhighlight %}</p><p>This algorithm is not perfect, I didn&rsquo;t want to spend a lot of time on this. For example I&rsquo;m checking
words with only the same length like the given one which obviously is not correct for a production algorithm&mldr;anyway
lets see the speed with one word.</p><p>{% highlight bash %}
Argiriss-MacBook-Pro:CmdSpellCorrection argi$ php correct.php applo
&mdash; Possible corrections for applo &mdash;
apolo
apple
apply
applz
Finished in 0.89617490768433 seconds
{% endhighlight %}</p><p>Hmm&mldr;pretty slow I cannot say that I&rsquo;m happy&mldr;let&rsquo;s try with 10 words</p><p>{% highlight bash %}
php correct.php ezer tost applo airplone feor shep boet garagi squirral buildang palintrame
Finished in 1.7699809074402 seconds
{% endhighlight %}</p><p>Interesting&mldr;I have a feeling that the I/O is a small bottleneck on the implementation&mldr;let me try
save the arrays per starting letter into a key/value&mldr;now the full algorithm becomes&mldr;</p><p>{% highlight php %}
&lt;?php
$memcache = new Memcache;
$memcache->connect(&lsquo;localhost&rsquo;, 11211) or die (&ldquo;Could not connect&rdquo;);</p><pre><code>$time_start = microtime(true);

$words = array();

if (!is_array($memcache-&gt;get('a'))) {

	$handle = @fopen(&quot;dictionary.txt&quot;, &quot;r&quot;);
	if ($handle) {
        while (($buffer = fgets($handle, 4096)) !== false) {
            $words[$buffer[0]][] = trim($buffer);
        }
        if (!feof($handle)) {
            echo &quot;Error: unexpected fgets() fail\n&quot;;
        }
        fclose($handle);
	}

	foreach ($words as $key =&gt; $eachWordArray) {
        $memcache-&gt;set($key, $eachWordArray) or die (&quot;Failed to save data at the server&quot;);
	}

}

// removing the first element since it's the name of the script
unset($argv[0]);

$reducedWords = array();
foreach ($argv as $input) {

	echo &quot;--- Possible corrections for $input ---\n&quot;;

	foreach ($memcache-&gt;get($input[0]) as $key =&gt; $value) {
        if (strlen($input) == strlen($value)) {
            $reducedWords[] = $value;
        }
	}

	foreach ($reducedWords as $key =&gt; $word) {

        $l = strlen($input);
        $index = 0;

        for ($i=0; $i &lt; $l; $i++) {
            if (isset($word[$i]) &amp;&amp; $input[$i] == $word[$i]) {
                $index++;
            }
        }

        if ($index &gt;= ($l-1)) {
            echo &quot;$word\n&quot;;
        }

	}

}

$time_end = microtime(true);
$time = $time_end - $time_start;

echo &quot;Finished in $time seconds\n&quot;;
</code></pre><p>{% endhighlight %}</p><p>I expect the first run to be slow because I still have to read the file and populate memcached&mldr;but the
second execution&mldr;</p><p>{% highlight bash %}
Argiriss-MacBook-Pro:CmdSpellCorrection argi$ php correct.php applo
&mdash; Possible corrections for applo &mdash;
apolo
apple
apply
applz
Finished in 0.076194047927856 seconds
{% endhighlight %}</p><p>And with 10 words..which is affected by the echo ofc&mldr;</p><p>{% highlight bash %}
php correct.php ezer tost applo airplone feor shep boet garagi squirral buildang palintrame
Finished in 1.0620329380035 seconds
{% endhighlight %}</p><p>Pretty impressive difference!! Cache ftw!</p><p>Like I said before this is attempt is just for the concept. The numbers can be much better with a faster machine
and the actual code needs improvements, but I didn&rsquo;t want to spend more than 20 minutes with this.</p><p>Hope you enjoyed it, I did :) &mldr; I think I would like to implement this in Scala&mldr;maybe for the next post.
The code is here <a href=https://github.com/agounaris/php_playground/tree/master/CmdSpellCorrection>CmdSpellCorrection</a></p><p>Cheers</p></div><footer class=article-footer><a data-url=https://agounaris.github.io/2014/02/12/php-auto-correction/spell-check-speed-testing/ data-id=d6a3358bab1dc2a0f60c0ca5f3c56fb9 class=article-share-link><i class="fa fa-share"></i></a>
<script>(function(a){if(typeof __SHARE_BUTTON_BINDED__=='undefined'||!__SHARE_BUTTON_BINDED__)__SHARE_BUTTON_BINDED__=!0;else return;a('body').on('click',function(){a('.article-share-box.on').removeClass('on')}).on('click','.article-share-link',function(i){var d,f,c,e,g,b,h;if(i.stopPropagation(),d=a(this),f=d.attr('data-url'),c=encodeURIComponent(f),e='article-share-box-'+d.attr('data-id'),g=d.offset(),a('#'+e).length){if(b=a('#'+e),b.hasClass('on')){b.removeClass('on');return}}else h=['<div id="'+e+'" class="article-share-box">','<input class="article-share-input" value="'+f+'">','<div class="article-share-links">','<a href="https://twitter.com/intent/tweet?url='+c+'" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>','<a href="https://www.facebook.com/sharer.php?u='+c+'" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>','<a href="http://pinterest.com/pin/create/button/?url='+c+'" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>','<a href="https://plus.google.com/share?url='+c+'" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>','</div>','</div>'].join(''),b=a(h),a('body').append(b);a('.article-share-box.on').hide(),b.css({top:g.top+25,left:g.left}).addClass('on')}).on('click','.article-share-box',function(a){a.stopPropagation()}).on('click','.article-share-box-input',function(){a(this).select()}).on('click','.article-share-box-link',function(a){a.preventDefault(),a.stopPropagation(),window.open(this.href,'article-share-box-window-'+Date.now(),'width=500,height=450')})})(jQuery)</script></footer></div><nav id=article-nav><a href=https://agounaris.github.io/2014/02/08/first-scala-tutorial-with-tests/ id=article-nav-older class=article-nav-link-wrap><strong class=article-nav-caption></strong><div class=article-nav-title>First Scala tutorial with tests</div></a><a href=https://agounaris.github.io/2014/10/01/a-few-thoughts-on-programming-and-not-only-ego.../ id=article-nav-newer class=article-nav-link-wrap><strong class=article-nav-caption></strong><div class=article-nav-title>A few thoughts on programming, and not only, ego...</div></a></nav></article></section><aside id=sidebar><div class=widget-wrap><h3 class=widget-title></h3><div class=widget><ul id=recent-post><li><div class=item-thumbnail><a href=https://agounaris.github.io/2017/05/01/stock-symbol-time-series-analysis-and-prediction-with-arima-model/ class=thumbnail><span class="thumbnail-image thumbnail-none"></span></a></div><div class=item-inner><p class=item-title><a href=https://agounaris.github.io/2017/05/01/stock-symbol-time-series-analysis-and-prediction-with-arima-model/ class=title>Stock symbol time series analysis and prediction with ARIMA model</a></p><p class=item-date><time datetime="2017-05-01 12:00:50 +0000 UTC" itemprop=datePublished>2017-05-01</time></p></div></li><li><div class=item-thumbnail><a href=https://agounaris.github.io/page/projects/ class=thumbnail><span class="thumbnail-image thumbnail-none"></span></a></div><div class=item-inner><p class=item-title><a href=https://agounaris.github.io/page/projects/ class=title>Projects</a></p><p class=item-date><time datetime="2015-04-03 02:13:50 +0000 UTC" itemprop=datePublished>2015-04-03</time></p></div></li><li><div class=item-thumbnail><a href=https://agounaris.github.io/page/contact/ class=thumbnail><span class="thumbnail-image thumbnail-none"></span></a></div><div class=item-inner><p class=item-title><a href=https://agounaris.github.io/page/contact/ class=title>Contact</a></p><p class=item-date><time datetime="2015-04-03 02:13:50 +0000 UTC" itemprop=datePublished>2015-04-03</time></p></div></li><li><div class=item-thumbnail><a href=https://agounaris.github.io/page/about/ class=thumbnail><span class="thumbnail-image thumbnail-none"></span></a></div><div class=item-inner><p class=item-title><a href=https://agounaris.github.io/page/about/ class=title>About</a></p><p class=item-date><time datetime="2015-04-03 02:13:50 +0000 UTC" itemprop=datePublished>2015-04-03</time></p></div></li><li><div class=item-thumbnail><a href=https://agounaris.github.io/2015/02/28/one-year-developing-with-elasticsearch/ class=thumbnail><span class="thumbnail-image thumbnail-none"></span></a></div><div class=item-inner><p class=item-title><a href=https://agounaris.github.io/2015/02/28/one-year-developing-with-elasticsearch/ class=title>One year developing with Elasticsearch</a></p><p class=item-date><time datetime="2015-02-28 02:13:50 +0000 UTC" itemprop=datePublished>2015-02-28</time></p></div></li></ul></div></div><div class=widget-wrap><h3 class=widget-title></h3><div class=widget><ul class=category-list><li class=category-list-item><a class=category-list-link href=https://agounaris.github.io/tags/php>php</a>
<span class=category-list-count>1</span></li><li class=category-list-item><a class=category-list-link href=https://agounaris.github.io/tags/python>python</a>
<span class=category-list-count>1</span></li><li class=category-list-item><a class=category-list-link href=https://agounaris.github.io/tags/symfony>symfony</a>
<span class=category-list-count>1</span></li></ul></div></div><div class=widget-wrap><h3 class=widget-title></h3><div class="widget tagcloud"><a href=https://agounaris.github.io/tags/php style=font-size:12px>php</a>
<a href=https://agounaris.github.io/tags/python style=font-size:12px>python</a>
<a href=https://agounaris.github.io/tags/symfony style=font-size:12px>symfony</a></div></div><div id=toTop class="fa fa-angle-up"></div></aside></div></div><footer id=footer><div class=outer><div id=footer-info class=inner>&copy; 2021
Powered by <a href=//gohugo.io>Hugo</a>. Theme by <a href=https://github.com/ppoffice>PPOffice</a>.</div></div></footer><script src=https://agounaris.github.io/fancybox/jquery.fancybox.pack.js></script><script src=https://agounaris.github.io/js/script.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>